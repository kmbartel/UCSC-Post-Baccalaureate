This project contains all the relevant pieces of my post-baccalaureate work at UC Santa Cruz during my 2024-25 gap year (Summer 2024 and academic year 2024-25). The goal of the project was to model the possible production and behavior of dark matter particles produced at Fermilab's DarkQuest experiment. To model the detector geometry and produce initial events, I used CERN's Geant4 toolkit and corresponding code written in C++. These initial events were then decayed by hand into potential dark matter particles (i.e. kaon0L --> pi0 + dark scalar) using Python code I've written, to be compared with actual DarkQuest data after an experimental run is completed. This work would have been impossible without the guidance of Prof. Stefania Gori.

Provided you have a working installation of Geant4 (see https://geant4.web.cern.ch), the .txt, .cc, .hh, and .ipynb files below are all you need to run both the DarkQuest detector simulation code to produce events and to subsequently decay them into dark matter using the Python code. Also included are the files used to produce the final plots of dark scalar momenta. For a summary, see below:

1. The files needed for the Geant4 detector simulation are as follows:
   a. CMakeLists.txt: Contains instructions describing the simulation's source files and targets.
   b. simDarkQuest.cc: The main program, containing the run manager, the physics list specifications (currently FTFP_BERT), and all visualization/UI commands.          Particle trajectories are set to be distinguished by particle ID, with colors set to default.
   c. action.cc: The program that initializes the generation of particles.
   d. action.hh: Contains header files for action.cc.
   e. construction.cc: The program that defines the detector geometry of DarkQuest. The 7 components of the detector are set in a "world volume", a 5m x 7m x 26m       box of air, and are: the FMag and beam dump (4.6m x 5m x 5m iron box), station 1 (2m x 2m x 1m silicon box), KMag (4m x 4m x 3m iron box with a 2m x 2m x         3m hole), station 2 (3m x 3m x 1m silicon box), station 3 (3m x 3m x 1m silicon box), the absorber wall (4m x 4m x 1m lead box), and station 4 (4m x 4m x         3m silicon box). Additionally, there is a "detector" made of air placed between the FMag/beam dump and station 1, though this has yet to be coded to detect       anything. The FMag/beam dump has a local magnetic field set to 1.8 tesla, defined at the bottom of the code.
   f. construction.hh: Contains header files for construction.cc.
   g. generator.cc: The program that defines the particle beam, set to generate a 120 GeV proton at the beginning of the world volume.
   h. generator.hh: Contains header files for generator.cc.
   i. physics.cc: The initialy used program that defined the physics lists to be used (EM and optical), now superceded by the alternative definition in                 simDarkQuest.cc.
   j. physics.hh: Contains header files for physics.cc.

2. "Particle Decays (1 to 2).ipynb" is the Python code written to decay the initial particles generated using the Geant4 code into their final dark matter states. There are two functions defined in this code: "find_two_daughter_momenta" and "find_two_daughter_momenta_angles". Given the mass of the parent and daughter particles, along with the momentum and energy of the parent, "find_two_daughter_momenta" returns the COM and lab frame momentum and energy of the daughter particles with no angles assumed. Given the mass of the parent and daughter particles, along with the momentum and energy of the parent and the angles associated with one of the daughter particles, "find_two_daughter_momenta_angles" returns the lab frame 4-momenta of the daughter particles with the assumed angles, in the form (E, p_x, p_y, p_z).
